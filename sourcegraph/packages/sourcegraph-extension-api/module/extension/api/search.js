import { ProviderMap } from './common';
export class ExtSearch {
    constructor(proxy) {
        this.proxy = proxy;
        this.registrations = new ProviderMap(id => this.proxy.$unregister(id));
    }
    registerQueryTransformer(provider) {
        const { id, subscription } = this.registrations.add(provider);
        this.proxy.$registerQueryTransformer(id);
        return subscription;
    }
    $transformQuery(id, query) {
        const provider = this.registrations.get(id);
        return Promise.resolve(provider.transformQuery(query));
    }
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoic2VhcmNoLmpzIiwic291cmNlUm9vdCI6InNyYy8iLCJzb3VyY2VzIjpbImV4dGVuc2lvbi9hcGkvc2VhcmNoLnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUdBLE9BQU8sRUFBRSxXQUFXLEVBQUUsTUFBTSxVQUFVLENBQUE7QUFNdEMsTUFBTSxPQUFPLFNBQVM7SUFFbEIsWUFBb0IsS0FBZ0I7UUFBaEIsVUFBSyxHQUFMLEtBQUssQ0FBVztRQUQ1QixrQkFBYSxHQUFHLElBQUksV0FBVyxDQUFtQixFQUFFLENBQUMsRUFBRSxDQUFDLElBQUksQ0FBQyxLQUFLLENBQUMsV0FBVyxDQUFDLEVBQUUsQ0FBQyxDQUFDLENBQUE7SUFDcEQsQ0FBQztJQUVqQyx3QkFBd0IsQ0FBQyxRQUEwQjtRQUN0RCxNQUFNLEVBQUUsRUFBRSxFQUFFLFlBQVksRUFBRSxHQUFHLElBQUksQ0FBQyxhQUFhLENBQUMsR0FBRyxDQUFDLFFBQVEsQ0FBQyxDQUFBO1FBQzdELElBQUksQ0FBQyxLQUFLLENBQUMseUJBQXlCLENBQUMsRUFBRSxDQUFDLENBQUE7UUFDeEMsT0FBTyxZQUFZLENBQUE7SUFDdkIsQ0FBQztJQUVNLGVBQWUsQ0FBQyxFQUFVLEVBQUUsS0FBYTtRQUM1QyxNQUFNLFFBQVEsR0FBRyxJQUFJLENBQUMsYUFBYSxDQUFDLEdBQUcsQ0FBbUIsRUFBRSxDQUFDLENBQUE7UUFDN0QsT0FBTyxPQUFPLENBQUMsT0FBTyxDQUFDLFFBQVEsQ0FBQyxjQUFjLENBQUMsS0FBSyxDQUFDLENBQUMsQ0FBQTtJQUMxRCxDQUFDO0NBQ0oiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBVbnN1YnNjcmliYWJsZSB9IGZyb20gJ3J4anMnXG5pbXBvcnQgeyBRdWVyeVRyYW5zZm9ybWVyIH0gZnJvbSAnc291cmNlZ3JhcGgnXG5pbXBvcnQgeyBTZWFyY2hBUEkgfSBmcm9tICdzcmMvY2xpZW50L2FwaS9zZWFyY2gnXG5pbXBvcnQgeyBQcm92aWRlck1hcCB9IGZyb20gJy4vY29tbW9uJ1xuXG5leHBvcnQgaW50ZXJmYWNlIEV4dFNlYXJjaEFQSSB7XG4gICAgJHRyYW5zZm9ybVF1ZXJ5OiAoaWQ6IG51bWJlciwgcXVlcnk6IHN0cmluZykgPT4gUHJvbWlzZTxzdHJpbmc+XG59XG5cbmV4cG9ydCBjbGFzcyBFeHRTZWFyY2ggaW1wbGVtZW50cyBFeHRTZWFyY2hBUEkge1xuICAgIHByaXZhdGUgcmVnaXN0cmF0aW9ucyA9IG5ldyBQcm92aWRlck1hcDxRdWVyeVRyYW5zZm9ybWVyPihpZCA9PiB0aGlzLnByb3h5LiR1bnJlZ2lzdGVyKGlkKSlcbiAgICBjb25zdHJ1Y3Rvcihwcml2YXRlIHByb3h5OiBTZWFyY2hBUEkpIHt9XG5cbiAgICBwdWJsaWMgcmVnaXN0ZXJRdWVyeVRyYW5zZm9ybWVyKHByb3ZpZGVyOiBRdWVyeVRyYW5zZm9ybWVyKTogVW5zdWJzY3JpYmFibGUge1xuICAgICAgICBjb25zdCB7IGlkLCBzdWJzY3JpcHRpb24gfSA9IHRoaXMucmVnaXN0cmF0aW9ucy5hZGQocHJvdmlkZXIpXG4gICAgICAgIHRoaXMucHJveHkuJHJlZ2lzdGVyUXVlcnlUcmFuc2Zvcm1lcihpZClcbiAgICAgICAgcmV0dXJuIHN1YnNjcmlwdGlvblxuICAgIH1cblxuICAgIHB1YmxpYyAkdHJhbnNmb3JtUXVlcnkoaWQ6IG51bWJlciwgcXVlcnk6IHN0cmluZyk6IFByb21pc2U8c3RyaW5nPiB7XG4gICAgICAgIGNvbnN0IHByb3ZpZGVyID0gdGhpcy5yZWdpc3RyYXRpb25zLmdldDxRdWVyeVRyYW5zZm9ybWVyPihpZClcbiAgICAgICAgcmV0dXJuIFByb21pc2UucmVzb2x2ZShwcm92aWRlci50cmFuc2Zvcm1RdWVyeShxdWVyeSkpXG4gICAgfVxufVxuIl19