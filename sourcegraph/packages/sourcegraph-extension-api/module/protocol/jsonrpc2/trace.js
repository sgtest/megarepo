// Copied from vscode-jsonrpc to avoid adding extraneous dependencies.
export var Trace;
(function (Trace) {
    Trace["Off"] = "off";
    Trace["Messages"] = "messages";
    Trace["Verbose"] = "verbose";
})(Trace || (Trace = {}));
/** A tracer that implements the Tracer interface with noop methods. */
export const noopTracer = {
    log: () => void 0,
    requestSent: () => void 0,
    requestReceived: () => void 0,
    notificationSent: () => void 0,
    notificationReceived: () => void 0,
    responseSent: () => void 0,
    responseCanceled: () => void 0,
    responseReceived: () => void 0,
    unknownResponseReceived: () => void 0,
};
/** A tracer that implements the Tracer interface with console API calls, intended for a web browser. */
export class BrowserConsoleTracer {
    constructor(name) {
        this.name = name;
    }
    prefix(level, label, title) {
        let color;
        let backgroundColor;
        if (level === 'info') {
            color = '#000';
            backgroundColor = '#eee';
        }
        else {
            color = 'white';
            backgroundColor = 'red';
        }
        return [
            '%c%s%c %s%c%s%c',
            `font-weight:bold;background-color:#d8f7ff;color:black`,
            this.name,
            '',
            label,
            `background-color:${backgroundColor};color:${color};font-weight:bold`,
            title,
            '',
        ];
    }
    log(message, details) {
        if (details) {
            ;
            console.groupCollapsed(...this.prefix('info', 'log', ''), message);
            console.log(details);
            console.groupEnd();
        }
        else {
            console.log(...this.prefix('info', 'log', ''), message);
        }
    }
    requestSent(message) {
        console.log(...this.prefix('info', `◀◀ sent request #${message.id}: `, message.method), message.params);
    }
    requestReceived(message) {
        console.log(...this.prefix('info', `▶▶ recv request #${message.id}: `, message.method), message.params);
    }
    notificationSent(message) {
        console.log(...this.prefix('info', `◀◀ sent notif: `, message.method), message.params);
    }
    notificationReceived(message) {
        console.log(...this.prefix('info', `▶▶ recv notif: `, message.method), message.params);
    }
    responseSent(message, request, startTime) {
        const prefix = this.prefix(message.error ? 'error' : 'info', `◀▶ sent response #${message.id}: `, typeof request === 'string' ? request : request.method);
        console.groupCollapsed(...prefix);
        if (message.error) {
            console.log('Error:', message.error);
        }
        else {
            console.log('Result:', message.result);
        }
        console.log('Request:', request);
        console.log('Duration: %d msec', Date.now() - startTime);
        console.groupEnd();
    }
    responseCanceled(_message, request, _cancelMessage) {
        console.log(...this.prefix('info', '× cancel: ', request.method));
    }
    responseReceived(message, request, startTime) {
        const prefix = this.prefix(message.error ? 'error' : 'info', `◀▶ recv response #${message.id}: `, typeof request === 'string' ? request : request.method);
        if (typeof request === 'string') {
            console.log(...prefix, message.error || message.result);
        }
        else {
            ;
            console.groupCollapsed(...prefix);
            if (message.error) {
                console.log('Error:', message.error);
            }
            else {
                console.log('Result:', message.result);
            }
            console.log('Request:', request);
            console.log('Duration: %d msec', Date.now() - startTime);
            console.groupEnd();
        }
    }
    unknownResponseReceived(message) {
        console.log(...this.prefix('error', 'UNKNOWN', ''), message);
    }
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoidHJhY2UuanMiLCJzb3VyY2VSb290Ijoic3JjLyIsInNvdXJjZXMiOlsicHJvdG9jb2wvanNvbnJwYzIvdHJhY2UudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBRUEsc0VBQXNFO0FBRXRFLE1BQU0sQ0FBTixJQUFZLEtBSVg7QUFKRCxXQUFZLEtBQUs7SUFDYixvQkFBVyxDQUFBO0lBQ1gsOEJBQXFCLENBQUE7SUFDckIsNEJBQW1CLENBQUE7QUFDdkIsQ0FBQyxFQUpXLEtBQUssS0FBTCxLQUFLLFFBSWhCO0FBZUQsdUVBQXVFO0FBQ3ZFLE1BQU0sQ0FBQyxNQUFNLFVBQVUsR0FBVztJQUM5QixHQUFHLEVBQUUsR0FBRyxFQUFFLENBQUMsS0FBSyxDQUFDO0lBQ2pCLFdBQVcsRUFBRSxHQUFHLEVBQUUsQ0FBQyxLQUFLLENBQUM7SUFDekIsZUFBZSxFQUFFLEdBQUcsRUFBRSxDQUFDLEtBQUssQ0FBQztJQUM3QixnQkFBZ0IsRUFBRSxHQUFHLEVBQUUsQ0FBQyxLQUFLLENBQUM7SUFDOUIsb0JBQW9CLEVBQUUsR0FBRyxFQUFFLENBQUMsS0FBSyxDQUFDO0lBQ2xDLFlBQVksRUFBRSxHQUFHLEVBQUUsQ0FBQyxLQUFLLENBQUM7SUFDMUIsZ0JBQWdCLEVBQUUsR0FBRyxFQUFFLENBQUMsS0FBSyxDQUFDO0lBQzlCLGdCQUFnQixFQUFFLEdBQUcsRUFBRSxDQUFDLEtBQUssQ0FBQztJQUM5Qix1QkFBdUIsRUFBRSxHQUFHLEVBQUUsQ0FBQyxLQUFLLENBQUM7Q0FDeEMsQ0FBQTtBQUVELHdHQUF3RztBQUN4RyxNQUFNLE9BQU8sb0JBQW9CO0lBQzdCLFlBQTJCLElBQVk7UUFBWixTQUFJLEdBQUosSUFBSSxDQUFRO0lBQUcsQ0FBQztJQUVuQyxNQUFNLENBQUMsS0FBdUIsRUFBRSxLQUFhLEVBQUUsS0FBYTtRQUNoRSxJQUFJLEtBQWEsQ0FBQTtRQUNqQixJQUFJLGVBQXVCLENBQUE7UUFDM0IsSUFBSSxLQUFLLEtBQUssTUFBTSxFQUFFO1lBQ2xCLEtB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LENBQUE7YUFDekM7WUFDRCxPQUFPLENBQUMsR0FBRyxDQUFDLFVBQVUsRUFBRSxPQUFPLENBQUMsQ0FBQTtZQUNoQyxPQUFPLENBQUMsR0FBRyxDQUFDLG1CQUFtQixFQUFFLElBQUksQ0FBQyxHQUFHLEVBQUUsR0FBRyxTQUFTLENBQUMsQ0FBQTtZQUN4RCxPQUFPLENBQUMsUUFBUSxFQUFFLENBQUE7U0FDckI7SUFDTCxDQUFDO0lBRU0sdUJBQXVCLENBQUMsT0FBd0I7UUFDbkQsT0FBTyxDQUFDLEdBQUcsQ0FBQyxHQUFHLElBQUksQ0FBQyxNQUFNLENBQUMsT0FBTyxFQUFFLFNBQVMsRUFBRSxFQUFFLENBQUMsRUFBRSxPQUFPLENBQUMsQ0FBQTtJQUNoRSxDQUFDO0NBQ0oiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBOb3RpZmljYXRpb25NZXNzYWdlLCBSZXF1ZXN0TWVzc2FnZSwgUmVzcG9uc2VNZXNzYWdlIH0gZnJvbSAnLi9tZXNzYWdlcydcblxuLy8gQ29waWVkIGZyb20gdnNjb2RlLWpzb25ycGMgdG8gYXZvaWQgYWRkaW5nIGV4dHJhbmVvdXMgZGVwZW5kZW5jaWVzLlxuXG5leHBvcnQgZW51bSBUcmFjZSB7XG4gICAgT2ZmID0gJ29mZicsXG4gICAgTWVzc2FnZXMgPSAnbWVzc2FnZXMnLFxuICAgIFZlcmJvc2UgPSAndmVyYm9zZScsXG59XG5cbi8qKiBSZWNvcmRzIG1lc3NhZ2VzIHNlbnQgYW5kIHJlY2VpdmVkIG9uIGEgSlNPTi1SUEMgMi4wIGNvbm5lY3Rpb24uICovXG5leHBvcnQgaW50ZXJmYWNlIFRyYWNlciB7XG4gICAgbG9nKG1lc3NhZ2U6IHN0cmluZywgZGV0YWlscz86IHN0cmluZyk6IHZvaWRcbiAgICByZXF1ZXN0U2VudChtZXNzYWdlOiBSZXF1ZXN0TWVzc2FnZSk6IHZvaWRcbiAgICByZXF1ZXN0UmVjZWl2ZWQobWVzc2FnZTogUmVxdWVzdE1lc3NhZ2UpOiB2b2lkXG4gICAgbm90aWZpY2F0aW9uU2VudChtZXNzYWdlOiBOb3RpZmljYXRpb25NZXNzYWdlKTogdm9pZFxuICAgIG5vdGlmaWNhdGlvblJlY2VpdmVkKG1lc3NhZ2U6IE5vdGlmaWNhdGlvbk1lc3NhZ2UpOiB2b2lkXG4gICAgcmVzcG9uc2VTZW50KG1lc3NhZ2U6IFJlc3BvbnNlTWVzc2FnZSwgcmVxdWVzdDogUmVxdWVzdE1lc3NhZ2UsIHN0YXJ0VGltZTogbnVtYmVyKTogdm9pZFxuICAgIHJlc3BvbnNlQ2FuY2VsZWQobWVzc2FnZTogUmVzcG9uc2VNZXNzYWdlLCByZXF1ZXN0OiBSZXF1ZXN0TWVzc2FnZSwgY2FuY2VsTWVzc2FnZTogTm90aWZpY2F0aW9uTWVzc2FnZSk6IHZvaWRcbiAgICByZXNwb25zZVJlY2VpdmVkKG1lc3NhZ2U6IFJlc3BvbnNlTWVzc2FnZSwgcmVxdWVzdDogUmVxdWVzdE1lc3NhZ2UgfCBzdHJpbmcsIHN0YXJ0VGltZTogbnVtYmVyKTogdm9pZFxuICAgIHVua25vd25SZXNwb25zZVJlY2VpdmVkKG1lc3NhZ2U6IFJlc3BvbnNlTWVzc2FnZSk6IHZvaWRcbn1cblxuLyoqIEEgdHJhY2VyIHRoYXQgaW1wbGVtZW50cyB0aGUgVHJhY2VyIGludGVyZmFjZSB3aXRoIG5vb3AgbWV0aG9kcy4gKi9cbmV4cG9ydCBjb25zdCBub29wVHJhY2VyOiBUcmFjZXIgPSB7XG4gICAgbG9nOiAoKSA9PiB2b2lkIDAsXG4gICAgcmVxdWVzdFNlbnQ6ICgpID0+IHZvaWQgMCxcbiAgICByZXF1ZXN0UmVjZWl2ZWQ6ICgpID0+IHZvaWQgMCxcbiAgICBub3RpZmljYXRpb25TZW50OiAoKSA9PiB2b2lkIDAsXG4gICAgbm90aWZpY2F0aW9uUmVjZWl2ZWQ6ICgpID0+IHZvaWQgMCxcbiAgICByZXNwb25zZVNlbnQ6ICgpID0+IHZvaWQgMCxcbiAgICByZXNwb25zZUNhbmNlbGVkOiAoKSA9PiB2b2lkIDAsXG4gICAgcmVzcG9uc2VSZWNlaXZlZDogKCkgPT4gdm9pZCAwLFxuICAgIHVua25vd25SZXNwb25zZVJlY2VpdmVkOiAoKSA9PiB2b2lkIDAsXG59XG5cbi8qKiBBIHRyYWNlciB0aGF0IGltcGxlbWVudHMgdGhlIFRyYWNlciBpbnRlcmZhY2Ugd2l0aCBjb25zb2xlIEFQSSBjYWxscywgaW50ZW5kZWQgZm9yIGEgd2ViIGJyb3dzZXIuICovXG5leHBvcnQgY2xhc3MgQnJvd3NlckNvbnNvbGVUcmFjZXIgaW1wbGVtZW50cyBUcmFjZXIge1xuICAgIHB1YmxpYyBjb25zdHJ1Y3Rvcihwcml2YXRlIG5hbWU6IHN0cmluZykge31cblxuICAgIHByaXZhdGUgcHJlZml4KGxldmVsOiAnaW5mbycgfCAnZXJyb3InLCBsYWJlbDogc3RyaW5nLCB0aXRsZTogc3RyaW5nKTogc3RyaW5nW10ge1xuICAgICAgICBsZXQgY29sb3I6IHN0cmluZ1xuICAgICAgICBsZXQgYmFja2dyb3VuZENvbG9yOiBzdHJpbmdcbiAgICAgICAgaWYgKGxldmVsID09PSAnaW5mbycpIHtcbiAgICAgICAgICAgIGNvbG9yID0gJyMwMDAnXG4gICAgICAgICAgICBiYWNrZ3JvdW5kQ29sb3IgPSAnI2VlZSdcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIGNvbG9yID0gJ3doaXRlJ1xuICAgICAgICAgICAgYmFja2dyb3VuZENvbG9yID0gJ3JlZCdcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gW1xuICAgICAgICAgICAgJyVjJXMlYyAlcyVjJXMlYycsXG4gICAgICAgICAgICBgZm9udC13ZWlnaHQ6Ym9sZDtiYWNrZ3JvdW5kLWNvbG9yOiNkOGY3ZmY7Y29sb3I6YmxhY2tgLFxuICAgICAgICAgICAgdGhpcy5uYW1lLFxuICAgICAgICAgICAgJycsXG4gICAgICAgICAgICBsYWJlbCxcbiAgICAgICAgICAgIGBiYWNrZ3JvdW5kLWNvbG9yOiR7YmFja2dyb3VuZENvbG9yfTtjb2xvcjoke2NvbG9yfTtmb250LXdlaWdodDpib2xkYCxcbiAgICAgICAgICAgIHRpdGxlLFxuICAgICAgICAgICAgJycsXG4gICAgICAgIF1cbiAgICB9XG5cbiAgICBwdWJsaWMgbG9nKG1lc3NhZ2U6IHN0cmluZywgZGV0YWlscz86IHN0cmluZyk6IHZvaWQge1xuICAgICAgICBpZiAoZGV0YWlscykge1xuICAgICAgICAgICAgOyhjb25zb2xlLmdyb3VwQ29sbGFwc2VkIGFzIGFueSkoLi4udGhpcy5wcmVmaXgoJ2luZm8nLCAnbG9nJywgJycpLCBtZXNzYWdlKVxuICAgICAgICAgICAgY29uc29sZS5sb2coZGV0YWlscylcbiAgICAgICAgICAgIGNvbnNvbGUuZ3JvdXBFbmQoKVxuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgY29uc29sZS5sb2coLi4udGhpcy5wcmVmaXgoJ2luZm8nLCAnbG9nJywgJycpLCBtZXNzYWdlKVxuICAgICAgICB9XG4gICAgfVxuXG4gICAgcHVibGljIHJlcXVlc3RTZW50KG1lc3NhZ2U6IFJlcXVlc3RNZXNzYWdlKTogdm9pZCB7XG4gICAgICAgIGNvbnNvbGUubG9nKC4uLnRoaXMucHJlZml4KCdpbmZvJywgYOKXgOKXgCBzZW50IHJlcXVlc3QgIyR7bWVzc2FnZS5pZH06IGAsIG1lc3NhZ2UubWV0aG9kKSwgbWVzc2FnZS5wYXJhbXMpXG4gICAgfVxuXG4gICAgcHVibGljIHJlcXVlc3RSZWNlaXZlZChtZXNzYWdlOiBSZXF1ZXN0TWVzc2FnZSk6IHZvaWQge1xuICAgICAgICBjb25zb2xlLmxvZyguLi50aGlzLnByZWZpeCgnaW5mbycsIGDilrbilrYgcmVjdiByZXF1ZXN0ICMke21lc3NhZ2UuaWR9OiBgLCBtZXNzYWdlLm1ldGhvZCksIG1lc3NhZ2UucGFyYW1zKVxuICAgIH1cblxuICAgIHB1YmxpYyBub3RpZmljYXRpb25TZW50KG1lc3NhZ2U6IE5vdGlmaWNhdGlvbk1lc3NhZ2UpOiB2b2lkIHtcbiAgICAgICAgY29uc29sZS5sb2coLi4udGhpcy5wcmVmaXgoJ2luZm8nLCBg4peA4peAIHNlbnQgbm90aWY6IGAsIG1lc3NhZ2UubWV0aG9kKSwgbWVzc2FnZS5wYXJhbXMpXG4gICAgfVxuXG4gICAgcHVibGljIG5vdGlmaWNhdGlvblJlY2VpdmVkKG1lc3NhZ2U6IE5vdGlmaWNhdGlvbk1lc3NhZ2UpOiB2b2lkIHtcbiAgICAgICAgY29uc29sZS5sb2coLi4udGhpcy5wcmVmaXgoJ2luZm8nLCBg4pa24pa2IHJlY3Ygbm90aWY6IGAsIG1lc3NhZ2UubWV0aG9kKSwgbWVzc2FnZS5wYXJhbXMpXG4gICAgfVxuXG4gICAgcHVibGljIHJlc3BvbnNlU2VudChtZXNzYWdlOiBSZXNwb25zZU1lc3NhZ2UsIHJlcXVlc3Q6IFJlcXVlc3RNZXNzYWdlLCBzdGFydFRpbWU6IG51bWJlcik6IHZvaWQge1xuICAgICAgICBjb25zdCBwcmVmaXggPSB0aGlzLnByZWZpeChcbiAgICAgICAgICAgIG1lc3NhZ2UuZXJyb3IgPyAnZXJyb3InIDogJ2luZm8nLFxuICAgICAgICAgICAgYOKXgOKWtiBzZW50IHJlc3BvbnNlICMke21lc3NhZ2UuaWR9OiBgLFxuICAgICAgICAgICAgdHlwZW9mIHJlcXVlc3QgPT09ICdzdHJpbmcnID8gcmVxdWVzdCA6IHJlcXVlc3QubWV0aG9kXG4gICAgICAgIClcbiAgICAgICAgOyhjb25zb2xlLmdyb3VwQ29sbGFwc2VkIGFzIGFueSkoLi4ucHJlZml4KVxuICAgICAgICBpZiAobWVzc2FnZS5lcnJvcikge1xuICAgICAgICAgICAgY29uc29sZS5sb2coJ0Vycm9yOicsIG1lc3NhZ2UuZXJyb3IpXG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBjb25zb2xlLmxvZygnUmVzdWx0OicsIG1lc3NhZ2UucmVzdWx0KVxuICAgICAgICB9XG4gICAgICAgIGNvbnNvbGUubG9nKCdSZXF1ZXN0OicsIHJlcXVlc3QpXG4gICAgICAgIGNvbnNvbGUubG9nKCdEdXJhdGlvbjogJWQgbXNlYycsIERhdGUubm93KCkgLSBzdGFydFRpbWUpXG4gICAgICAgIGNvbnNvbGUuZ3JvdXBFbmQoKVxuICAgIH1cblxuICAgIHB1YmxpYyByZXNwb25zZUNhbmNlbGVkKFxuICAgICAgICBfbWVzc2FnZTogUmVzcG9uc2VNZXNzYWdlLFxuICAgICAgICByZXF1ZXN0OiBSZXF1ZXN0TWVzc2FnZSxcbiAgICAgICAgX2NhbmNlbE1lc3NhZ2U6IE5vdGlmaWNhdGlvbk1lc3NhZ2VcbiAgICApOiB2b2lkIHtcbiAgICAgICAgY29uc29sZS5sb2coLi4udGhpcy5wcmVmaXgoJ2luZm8nLCAnw5cgY2FuY2VsOiAnLCByZXF1ZXN0Lm1ldGhvZCkpXG4gICAgfVxuXG4gICAgcHVibGljIHJlc3BvbnNlUmVjZWl2ZWQobWVzc2FnZTogUmVzcG9uc2VNZXNzYWdlLCByZXF1ZXN0OiBSZXF1ZXN0TWVzc2FnZSB8IHN0cmluZywgc3RhcnRUaW1lOiBudW1iZXIpOiB2b2lkIHtcbiAgICAgICAgY29uc3QgcHJlZml4ID0gdGhpcy5wcmVmaXgoXG4gICAgICAgICAgICBtZXNzYWdlLmVycm9yID8gJ2Vycm9yJyA6ICdpbmZvJyxcbiAgICAgICAgICAgIGDil4DilrYgcmVjdiByZXNwb25zZSAjJHttZXNzYWdlLmlkfTogYCxcbiAgICAgICAgICAgIHR5cGVvZiByZXF1ZXN0ID09PSAnc3RyaW5nJyA/IHJlcXVlc3QgOiByZXF1ZXN0Lm1ldGhvZFxuICAgICAgICApXG4gICAgICAgIGlmICh0eXBlb2YgcmVxdWVzdCA9PT0gJ3N0cmluZycpIHtcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKC4uLnByZWZpeCwgbWVzc2FnZS5lcnJvciB8fCBtZXNzYWdlLnJlc3VsdClcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIDsoY29uc29sZS5ncm91cENvbGxhcHNlZCBhcyBhbnkpKC4uLnByZWZpeClcbiAgICAgICAgICAgIGlmIChtZXNzYWdlLmVycm9yKSB7XG4gICAgICAgICAgICAgICAgY29uc29sZS5sb2coJ0Vycm9yOicsIG1lc3NhZ2UuZXJyb3IpXG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKCdSZXN1bHQ6JywgbWVzc2FnZS5yZXN1bHQpXG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBjb25zb2xlLmxvZygnUmVxdWVzdDonLCByZXF1ZXN0KVxuICAgICAgICAgICAgY29uc29sZS5sb2coJ0R1cmF0aW9uOiAlZCBtc2VjJywgRGF0ZS5ub3coKSAtIHN0YXJ0VGltZSlcbiAgICAgICAgICAgIGNvbnNvbGUuZ3JvdXBFbmQoKVxuICAgICAgICB9XG4gICAgfVxuXG4gICAgcHVibGljIHVua25vd25SZXNwb25zZVJlY2VpdmVkKG1lc3NhZ2U6IFJlc3BvbnNlTWVzc2FnZSk6IHZvaWQge1xuICAgICAgICBjb25zb2xlLmxvZyguLi50aGlzLnByZWZpeCgnZXJyb3InLCAnVU5LTk9XTicsICcnKSwgbWVzc2FnZSlcbiAgICB9XG59XG4iXX0=