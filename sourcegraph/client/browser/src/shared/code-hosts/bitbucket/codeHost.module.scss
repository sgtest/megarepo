/* Open on Sourcegraph button */
.open-on-sourcegraph {
    margin-left: 2px; /* same as other buttons in the row */
}

.sg-toolbar-mount,
.code-view-toolbar {
    /* Layout action item children within the .secondary wrapping context,
     * so they wrap together with the native Bitbucket buttons */
    display: contents;
}

.action-nav-item {
    margin-left: 5px;
    margin-top: 5px;
}

.action-nav-item-new-diff {
    margin: 0 8px 0 2px;
}

.action-item-new-diff {
    background-color: rgba(9, 30, 66, 0.04);
    color: rgba(66, 82, 110);
    transition: background 0.1s ease-out 0s, box-shadow 0.15s cubic-bezier(0.47, 0.03, 0.49, 1.38) 0s;
    display: inline-flex;
    align-items: center;
    justify-content: center;
    border-radius: 3px;
    height: 100%;
    width: 24px;
    padding: 0 2px;

    &:hover {
        background: rgba(9, 30, 66, 0.08);
    }
}

/* Use flexbox instead of float, so we can handle wrapping action items */
:global(.file-toolbar) {
    display: flex;
    align-items: center;

    /* Trigger a two-row layout if file path and action items don't fit all in one row. */
    flex-wrap: wrap;

    > :global(.primary) {
        /* Make sure file paths don't wrap to make space for buttons
         * (instead trigger a two-row layout if it does not fit) */
        flex: 0 2 auto;
        order: 1;
    }

    > :global(.secondary) {
        /* Overrides */
        float: none;
        white-space: normal;
        line-height: initial;

        flex: 1 1 auto;
        flex-wrap: wrap;
        order: 2;

        display: flex;
        align-items: center;
        justify-content: flex-end;

        > :global(.aui-buttons) {
            /* Layout all child buttons within the parent wrapping context (.secondary),
             * so they wrap together with our toolbar buttons. */
            display: contents;

            > :global(.aui-button) {
                /* Reapply margins that are on the .aui-buttons element to the .aui-button elements,
                 * because the display: contents removes margins from the .aui-buttons element */
                margin-left: 5px;
                margin-top: 5px;
            }
        }
    }
}

.hover-overlay {
    // HoverOverlay max-width is defined in rem (https://sourcegraph.com/github.com/sourcegraph/sourcegraph@0a7bfc6c389b71484615e788a62b9ef262823726/-/blob/client/shared/src/hover/HoverOverlay.module.scss?L15).
    // Rem on Bitbucket equals to 14px vs 16px on Sourcegraph.
    // Set value in pixels to ensure content fits container.
    max-width: 544px !important; // 34rem * 16px in Sourcegraph web app
}

.hover-actions {
    > span:not(:first-child) {
        /* Add margin between buttons. */
        margin-left: 0.25rem !important;
    }
}

/* Hover overlay buttons */
.hover-action-item {
    margin: 0 !important;
    border-radius: 0 !important;
    border-bottom: none !important;
    border-top: none !important;
    border-right: none !important;

    &:first-child {
        border-left: none !important;
    }

    /* Add margin between buttons. Important is required to override the rule above. */
    & + & {
        margin-left: 0.25rem !important;
    }
}

.btn-icon {
    padding: 0 !important;
    background: transparent !important;
    border: none !important;
    height: 1rem !important;
    line-height: 1rem !important;

    &:global(.close) {
        margin-right: -1.25rem;
    }

    &:hover {
        opacity: 0.7;
    }
}
